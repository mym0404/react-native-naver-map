import { Callout, Steps, Tabs, FileTree } from 'nextra/components'

# Expo ì„¤ì •

Expo í”„ë¡œì íŠ¸ì—ì„œ React Native Naver Mapì„ ì„¤ì •í•˜ëŠ” ìƒì„¸ ê°€ì´ë“œì…ë‹ˆë‹¤.

<Callout type="info" emoji="ğŸ“±">
  Expo Goì—ì„œëŠ” ë„¤ì´í‹°ë¸Œ ëª¨ë“ˆì„ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. 
  Development Build ë˜ëŠ” Production Buildê°€ í•„ìš”í•©ë‹ˆë‹¤.
</Callout>

## ìš”êµ¬ì‚¬í•­

- Expo SDK 49 ì´ìƒ
- React Native 0.73 ì´ìƒ
- Development Build í™˜ê²½

## ì„¤ì • ë‹¨ê³„

<Steps>
### íŒ¨í‚¤ì§€ ì„¤ì¹˜

<Tabs items={['npm', 'yarn', 'pnpm', 'expo']}>
  <Tabs.Tab>
    ```bash
    npm install @mj-studio/react-native-naver-map
    npm install expo-build-properties
    ```
  </Tabs.Tab>
  <Tabs.Tab>
    ```bash
    yarn add @mj-studio/react-native-naver-map
    yarn add expo-build-properties
    ```
  </Tabs.Tab>
  <Tabs.Tab>
    ```bash
    pnpm add @mj-studio/react-native-naver-map
    pnpm add expo-build-properties
    ```
  </Tabs.Tab>
  <Tabs.Tab>
    ```bash
    npx expo install @mj-studio/react-native-naver-map
    npx expo install expo-build-properties
    ```
  </Tabs.Tab>
</Tabs>

<Callout>
  `expo-build-properties`ëŠ” Android Maven ì €ì¥ì†Œë¥¼ ì¶”ê°€í•˜ëŠ” ë° í•„ìš”í•©ë‹ˆë‹¤.
</Callout>

### app.json ì„¤ì •

`app.json` ë˜ëŠ” `app.config.js`ì— Config Pluginì„ ì¶”ê°€í•©ë‹ˆë‹¤:

```json {5-29}
{
  "expo": {
    "name": "your-app",
    "slug": "your-app",
    "plugins": [
      [
        "@mj-studio/react-native-naver-map",
        {
          "client_id": "YOUR_NAVER_MAP_CLIENT_ID",
          // Android ê¶Œí•œ ì„¤ì • (ì„ íƒì‚¬í•­)
          "android": {
            "ACCESS_FINE_LOCATION": true,
            "ACCESS_COARSE_LOCATION": true,
            "ACCESS_BACKGROUND_LOCATION": false
          },
          // iOS ê¶Œí•œ ì„¤ì • (ì„ íƒì‚¬í•­)
          "ios": {
            "NSLocationWhenInUseUsageDescription": "ì§€ë„ì—ì„œ í˜„ì¬ ìœ„ì¹˜ë¥¼ í‘œì‹œí•˜ê¸° ìœ„í•´ ìœ„ì¹˜ ì •ë³´ê°€ í•„ìš”í•©ë‹ˆë‹¤.",
            "NSLocationAlwaysAndWhenInUseUsageDescription": "ë°±ê·¸ë¼ìš´ë“œì—ì„œë„ ìœ„ì¹˜ë¥¼ ì¶”ì í•˜ê¸° ìœ„í•´ ìœ„ì¹˜ ì •ë³´ê°€ í•„ìš”í•©ë‹ˆë‹¤.",
            "NSLocationTemporaryUsageDescriptionDictionary": {
              "purposeKey": "MapNavigation",
              "usageDescription": "ì •í™•í•œ ë‚´ë¹„ê²Œì´ì…˜ì„ ìœ„í•´ ìœ„ì¹˜ ì •ë³´ê°€ í•„ìš”í•©ë‹ˆë‹¤."
            }
          }
        }
      ],
      [
        "expo-build-properties",
        {
          "android": {
            "extraMavenRepos": ["https://repository.map.naver.com/archive/maven"]
          }
        }
      ]
    ]
  }
}
```

### Development Build ìƒì„±

Expo GoëŠ” ë„¤ì´í‹°ë¸Œ ëª¨ë“ˆì„ ì§€ì›í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ Development Buildë¥¼ ìƒì„±í•´ì•¼ í•©ë‹ˆë‹¤:

<Tabs items={['ë¡œì»¬ ë¹Œë“œ', 'EAS Build']}>
  <Tabs.Tab>
    #### ë¡œì»¬ Development Build
    
    ```bash
    # iOS
    npx expo run:ios
    
    # Android
    npx expo run:android
    ```
    
    <Callout type="info">
      ì²˜ìŒ ì‹¤í–‰ ì‹œ ë„¤ì´í‹°ë¸Œ í”„ë¡œì íŠ¸ê°€ ìƒì„±ë˜ë©° ì‹œê°„ì´ ê±¸ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    </Callout>
  </Tabs.Tab>
  
  <Tabs.Tab>
    #### EAS Development Build
    
    1. EAS CLI ì„¤ì¹˜:
    ```bash
    npm install -g eas-cli
    ```
    
    2. EAS ì„¤ì •:
    ```bash
    eas build:configure
    ```
    
    3. Development Build ìƒì„±:
    ```bash
    # iOS
    eas build --platform ios --profile development
    
    # Android
    eas build --platform android --profile development
    ```
    
    4. ë¹Œë“œëœ ì•± ì„¤ì¹˜ í›„ ê°œë°œ ì„œë²„ ì—°ê²°:
    ```bash
    npx expo start --dev-client
    ```
  </Tabs.Tab>
</Tabs>

### ì•± ì‹¤í–‰

Development Buildê°€ ì„¤ì¹˜ë˜ë©´ ê°œë°œ ì„œë²„ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤:

```bash
npx expo start --dev-client
```
</Steps>

## í™˜ê²½ë³„ ì„¤ì •

### app.config.js ì‚¬ìš©

í™˜ê²½ë³„ë¡œ ë‹¤ë¥¸ ì„¤ì •ì„ ì‚¬ìš©í•˜ë ¤ë©´ `app.config.js`ë¥¼ í™œìš©í•©ë‹ˆë‹¤:

```javascript
export default ({ config }) => {
  const isProduction = process.env.NODE_ENV === 'production';
  
  return {
    ...config,
    plugins: [
      [
        "@mj-studio/react-native-naver-map",
        {
          client_id: isProduction 
            ? process.env.NAVER_MAP_PROD_KEY 
            : process.env.NAVER_MAP_DEV_KEY,
          android: {
            ACCESS_FINE_LOCATION: true,
            ACCESS_COARSE_LOCATION: true,
          },
          ios: {
            NSLocationWhenInUseUsageDescription: "í˜„ì¬ ìœ„ì¹˜ë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.",
          }
        }
      ],
      [
        "expo-build-properties",
        {
          android: {
            extraMavenRepos: ["https://repository.map.naver.com/archive/maven"]
          }
        }
      ]
    ]
  };
};
```

## ìœ„ì¹˜ ê¶Œí•œ ì²˜ë¦¬

### expo-location ì‚¬ìš©

Expo í”„ë¡œì íŠ¸ì—ì„œëŠ” `expo-location`ì„ ì‚¬ìš©í•˜ì—¬ ìœ„ì¹˜ ê¶Œí•œì„ ì²˜ë¦¬í•˜ëŠ” ê²ƒì„ ê¶Œì¥í•©ë‹ˆë‹¤:

<Steps>
### ì„¤ì¹˜

```bash
npx expo install expo-location
```

### ê¶Œí•œ ìš”ì²­ êµ¬í˜„

```tsx
import * as Location from 'expo-location';
import { useEffect, useState } from 'react';

export function useLocationPermission() {
  const [permission, setPermission] = useState(null);
  const [location, setLocation] = useState(null);

  useEffect(() => {
    (async () => {
      // ê¶Œí•œ ìš”ì²­
      const { status } = await Location.requestForegroundPermissionsAsync();
      setPermission(status === 'granted');
      
      if (status === 'granted') {
        // í˜„ì¬ ìœ„ì¹˜ ê°€ì ¸ì˜¤ê¸°
        const currentLocation = await Location.getCurrentPositionAsync({});
        setLocation(currentLocation);
        
        // ë°±ê·¸ë¼ìš´ë“œ ê¶Œí•œ ìš”ì²­ (ì„ íƒì‚¬í•­)
        const { status: bgStatus } = await Location.requestBackgroundPermissionsAsync();
        console.log('ë°±ê·¸ë¼ìš´ë“œ ê¶Œí•œ:', bgStatus);
      }
    })();
  }, []);

  return { permission, location };
}
```

### ì§€ë„ì— ì ìš©

```tsx
import { NaverMapView } from '@mj-studio/react-native-naver-map';
import { useLocationPermission } from './useLocationPermission';

export default function MapScreen() {
  const { permission, location } = useLocationPermission();

  return (
    <NaverMapView
      style={{ flex: 1 }}
      initialRegion={location ? {
        latitude: location.coords.latitude,
        longitude: location.coords.longitude,
        latitudeDelta: 0.01,
        longitudeDelta: 0.01,
      } : undefined}
      isShowLocationButton={permission}
    />
  );
}
```
</Steps>

## ì¼ë°˜ì ì¸ ë¬¸ì œ í•´ê²°

### Expo Go ì˜¤ë¥˜

<Callout type="error" emoji="âŒ">
  **"Cannot read property 'NaverMapView' of undefined"**
</Callout>

Expo GoëŠ” ë„¤ì´í‹°ë¸Œ ëª¨ë“ˆì„ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. Development Buildë¥¼ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤:

```bash
npx expo run:ios
# ë˜ëŠ”
npx expo run:android
```

### í”ŒëŸ¬ê·¸ì¸ ì˜¤ë¥˜

<Callout type="error" emoji="âŒ">
  **"Config plugin not found"**
</Callout>

1. íŒ¨í‚¤ì§€ê°€ ì˜¬ë°”ë¥´ê²Œ ì„¤ì¹˜ë˜ì—ˆëŠ”ì§€ í™•ì¸
2. `expo prebuild --clear`ë¡œ ìºì‹œ í´ë¦¬ì–´
3. node_modules ì¬ì„¤ì¹˜

### Maven ì €ì¥ì†Œ ì˜¤ë¥˜

<Callout type="error" emoji="âŒ">
  **Android ë¹Œë“œ ì‹œ "Could not find com.naver.maps.map"**
</Callout>

`expo-build-properties` í”ŒëŸ¬ê·¸ì¸ì´ ì˜¬ë°”ë¥´ê²Œ ì„¤ì •ë˜ì—ˆëŠ”ì§€ í™•ì¸:

```json
[
  "expo-build-properties",
  {
    "android": {
      "extraMavenRepos": ["https://repository.map.naver.com/archive/maven"]
    }
  }
]
```

## í”„ë¡œë•ì…˜ ë¹Œë“œ

### EAS Build ì‚¬ìš©

```bash
# iOS í”„ë¡œë•ì…˜ ë¹Œë“œ
eas build --platform ios --profile production

# Android í”„ë¡œë•ì…˜ ë¹Œë“œ
eas build --platform android --profile production
```

### ë¡œì»¬ í”„ë¡œë•ì…˜ ë¹Œë“œ

```bash
# iOS
npx expo run:ios --configuration Release

# Android APK
npx expo run:android --variant release

# Android AAB
cd android && ./gradlew bundleRelease
```

## í”„ë¡œì íŠ¸ êµ¬ì¡°

Expo í”„ë¡œì íŠ¸ì˜ ê¶Œì¥ êµ¬ì¡°:

<FileTree>
  <FileTree.Folder name="your-expo-app" defaultOpen>
    <FileTree.File name="app.json" />
    <FileTree.File name="app.config.js" />
    <FileTree.File name="package.json" />
    <FileTree.File name=".env" />
    <FileTree.Folder name="src" defaultOpen>
      <FileTree.Folder name="components">
        <FileTree.File name="Map.tsx" />
      </FileTree.Folder>
      <FileTree.Folder name="hooks">
        <FileTree.File name="useLocationPermission.ts" />
      </FileTree.Folder>
    </FileTree.Folder>
    <FileTree.Folder name="ios">
      <FileTree.File name="(ìƒì„±ë¨)" />
    </FileTree.Folder>
    <FileTree.Folder name="android">
      <FileTree.File name="(ìƒì„±ë¨)" />
    </FileTree.Folder>
  </FileTree.Folder>
</FileTree>

## íŒê³¼ ëª¨ë²” ì‚¬ë¡€

### í™˜ê²½ ë³€ìˆ˜ ì‚¬ìš©

`.env` íŒŒì¼ë¡œ API í‚¤ ê´€ë¦¬:

```bash
# .env
EXPO_PUBLIC_NAVER_MAP_KEY=your_key_here
```

`app.config.js`:
```javascript
export default {
  expo: {
    plugins: [
      ["@mj-studio/react-native-naver-map", {
        client_id: process.env.EXPO_PUBLIC_NAVER_MAP_KEY
      }]
    ]
  }
};
```

### ê°œë°œ íš¨ìœ¨ì„±

1. **Fast Refresh í™œìš©**: ì§€ë„ ì„¤ì • ë³€ê²½ ì‹œ ì•± ì¬ì‹œì‘ ì—†ì´ ì—…ë°ì´íŠ¸
2. **ë””ë²„ê¹…**: React Native Debugger ë˜ëŠ” Flipper ì‚¬ìš©
3. **ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§**: React DevTools Profiler í™œìš©

## ë‹¤ìŒ ë‹¨ê³„

- [ì»´í¬ë„ŒíŠ¸ ê°€ì´ë“œ](/components) - ì§€ë„ ì»´í¬ë„ŒíŠ¸ ì‚¬ìš©ë²•
- [ê¶Œí•œ ì„¤ì •](/guides/permissions) - ìƒì„¸ ê¶Œí•œ ê°€ì´ë“œ
- [ìµœì í™” ê°€ì´ë“œ](/guides/performance) - ì„±ëŠ¥ ìµœì í™” íŒ